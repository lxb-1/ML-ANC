WARNING:absl:No GPU/TPU found, falling back to CPU. (Set TF_CPP_MIN_LOG_LEVEL=0 and rerun for more info.)
/home/liang/miniconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py:563: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Total of - 13729 - Trainable Parameters
Epoch Loop:   0%|                                                                                              | 0/200 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/liang/文档/Coding/Machine Learning/MetaAF/zoo/eq/eq.py", line 295, in <module>
    outer_learned, losses = system.train(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/meta.py", line 391, in train
    self.outer_learnable, aux = self.epoch_loop(meta_opt_s, key)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/meta.py", line 412, in epoch_loop
    train_loop_losses, meta_opt_s = self.train_loop(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/meta.py", line 543, in train_loop
    train_step_losses, aux = self.train_step(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/meta.py", line 605, in train_step
    train_step_losses, aux = self.outer_loop(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/api.py", line 2013, in cache_miss
    out_tree, out_flat = f_pmapped_(*args, **kwargs)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/api.py", line 1889, in pmap_f
    out = pxla.xla_pmap(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/core.py", line 1863, in bind
    return map_bind(self, fun, *args, **params)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/core.py", line 1895, in map_bind
    outs = primitive.process(top_trace, fun, tracers, params)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/core.py", line 1866, in process
    return trace.process_map(self, fun, tracers, params)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/core.py", line 660, in process_call
    return primitive.impl(f, *tracers, **params)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/interpreters/pxla.py", line 801, in xla_pmap_impl
    compiled_fun, fingerprint = parallel_callable(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/linear_util.py", line 285, in memoized_fun
    ans = call(fun, *args)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/interpreters/pxla.py", line 829, in parallel_callable
    pmap_computation = lower_parallel_callable(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/profiler.py", line 206, in wrapper
    return func(*args, **kwargs)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/interpreters/pxla.py", line 1002, in lower_parallel_callable
    jaxpr, consts, replicas, parts, shards = stage_parallel_callable(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/interpreters/pxla.py", line 909, in stage_parallel_callable
    jaxpr, out_sharded_avals, consts = pe.trace_to_jaxpr_final(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/profiler.py", line 206, in wrapper
    return func(*args, **kwargs)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 1844, in trace_to_jaxpr_final
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 1816, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/linear_util.py", line 168, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/api.py", line 466, in cache_miss
    out_flat = xla.xla_call(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/core.py", line 1771, in bind
    return call_bind(self, fun, *args, **params)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/core.py", line 1787, in call_bind
    outs = top_trace.process_call(primitive, fun_, tracers, params)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 1534, in process_call
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 1816, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/linear_util.py", line 168, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/core.py", line 366, in batch_run_outer_loop
    return run_outer_loop(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/api.py", line 466, in cache_miss
    out_flat = xla.xla_call(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/core.py", line 1771, in bind
    return call_bind(self, fun, *args, **params)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/core.py", line 1787, in call_bind
    outs = top_trace.process_call(primitive, fun_, tracers, params)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 1534, in process_call
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 1816, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/linear_util.py", line 168, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/core.py", line 359, in run_outer_loop
    final_state, (meta_losses, filter_loss, filter_out) = jax.lax.scan(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/lax/control_flow.py", line 1542, in scan
    init_flat, carry_avals, carry_avals_out, init_tree, *rest = _create_jaxpr(init)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/lax/control_flow.py", line 1528, in _create_jaxpr
    jaxpr, consts, out_tree = _initial_style_jaxpr(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/util.py", line 219, in wrapper
    return cached(config._trace_context(), *args, **kwargs)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/util.py", line 212, in cached
    return f(*args, **kwargs)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/lax/control_flow.py", line 83, in _initial_style_jaxpr
    jaxpr, consts, out_tree = _initial_style_open_jaxpr(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/util.py", line 219, in wrapper
    return cached(config._trace_context(), *args, **kwargs)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/util.py", line 212, in cached
    return f(*args, **kwargs)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/lax/control_flow.py", line 77, in _initial_style_open_jaxpr
    jaxpr, _, consts = pe.trace_to_jaxpr_dynamic(wrapped_fun, in_avals, debug)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/profiler.py", line 206, in wrapper
    return func(*args, **kwargs)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 1779, in trace_to_jaxpr_dynamic
    jaxpr, out_avals, consts = trace_to_subjaxpr_dynamic(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 1816, in trace_to_subjaxpr_dynamic
    ans = fun.call_wrapped(*in_tracers_)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/linear_util.py", line 168, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/core.py", line 301, in step_update_outer
    batch_signals_unroll = tree_slice_axis(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/core.py", line 30, in tree_slice_axis
    return tree_map(slice, tmap)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/tree_util.py", line 184, in tree_map
    return treedef.unflatten(f(*xs) for xs in zip(*all_leaves))
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/tree_util.py", line 184, in <genexpr>
    return treedef.unflatten(f(*xs) for xs in zip(*all_leaves))
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/core.py", line 24, in slice
    return jax.lax.dynamic_slice(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/lax/slicing.py", line 104, in dynamic_slice
    return dynamic_slice_p.bind(operand, *start_indices,
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/core.py", line 323, in bind
    return self.bind_with_trace(find_top_trace(args), args, params)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/core.py", line 326, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 1511, in process_primitive
    return self.default_process_primitive(primitive, tracers, params)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/interpreters/partial_eval.py", line 1515, in default_process_primitive
    out_avals, effects = primitive.abstract_eval(*avals, **params)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/core.py", line 359, in abstract_eval_
    return abstract_eval(*args, **kwargs), no_effects
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/lax/utils.py", line 66, in standard_abstract_eval
    return core.ShapedArray(shape_rule(*avals, **kwargs),
  File "/home/liang/miniconda3/lib/python3.9/site-packages/jax/_src/lax/slicing.py", line 836, in _dynamic_slice_shape_rule
    raise TypeError(msg.format(slice_sizes, operand.shape))
jax._src.traceback_util.UnfilteredStackTrace: TypeError: slice slice_sizes must be less than or equal to operand shape, got slice_sizes (16, 4096, 1) for operand shape (16, 1, 1).
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/home/liang/文档/Coding/Machine Learning/MetaAF/zoo/eq/eq.py", line 295, in <module>
    outer_learned, losses = system.train(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/meta.py", line 391, in train
    self.outer_learnable, aux = self.epoch_loop(meta_opt_s, key)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/meta.py", line 412, in epoch_loop
    train_loop_losses, meta_opt_s = self.train_loop(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/meta.py", line 543, in train_loop
    train_step_losses, aux = self.train_step(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/meta.py", line 605, in train_step
    train_step_losses, aux = self.outer_loop(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/core.py", line 366, in batch_run_outer_loop
    return run_outer_loop(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/core.py", line 359, in run_outer_loop
    final_state, (meta_losses, filter_loss, filter_out) = jax.lax.scan(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/core.py", line 301, in step_update_outer
    batch_signals_unroll = tree_slice_axis(
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/core.py", line 30, in tree_slice_axis
    return tree_map(slice, tmap)
  File "/home/liang/miniconda3/lib/python3.9/site-packages/metaaf/core.py", line 24, in slice
    return jax.lax.dynamic_slice(
TypeError: slice slice_sizes must be less than or equal to operand shape, got slice_sizes (16, 4096, 1) for operand shape (16, 1, 1).